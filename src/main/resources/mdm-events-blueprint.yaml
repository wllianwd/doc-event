asyncapi: '1.0.0'
info:
  title: 'MDM - Master Data Management'
  version: '1.0.0'
baseTopic: 'mdm'
host: 'local.umantis.lan:61616'
schemes:
  - 'amqp'

topics:
  mdm.idm_topic:
    subscribe:
      - $ref: "#/components/messages/identity_created"
      - $ref: "#/components/messages/identity_updated"
      - $ref: "#/components/messages/identity_deleted"
  mdm.rdm_topic:
    subscribe:
      - $ref: "#/components/messages/reference_data_created"
      - $ref: "#/components/messages/reference_data_updated"
      - $ref: "#/components/messages/reference_data_deleted"

components:
  messages:
    identity_created:
      summary: An identity was created
      description: A message notifying an identity has been created.
      payload:
        type: object
        properties:
          $ref: "#/components/schemas/mdm_event"
    identity_updated:
      summary: An identity was updated
      description: A message notifying an identity has been updated.
      payload:
        type: object
        properties:
          $ref: "#/components/schemas/mdm_event"
    identity_deleted:
      summary: An identity was deleted
      description: A message notifying an identity has been deleted.
      payload:
        type: object
        properties:
          $ref: "#/components/schemas/mdm_event"
    reference_data_created:
      summary: A reference data registry was created
      description: A message notifying a reference data registry has been created.
      payload:
        type: object
        properties:
          $ref: "#/components/schemas/mdm_event"
    reference_data_updated:
      summary: A reference data registry was updated
      description: A message notifying a reference data registry has been updated.
      payload:
        type: object
        properties:
          $ref: "#/components/schemas/mdm_event"
    reference_data_deleted:
      summary: A reference data registry was deleted
      description: A message notifying a reference data registry has been deleted.
      payload:
        type: object
        properties:
          $ref: "#/components/schemas/mdm_event"
          
  schemas:
    mdm_event:
      type: object
      required:
        - entity_id
        - action
        - link
      properties:
        entity_id:
          description: The entity ID
          type: string
        action:
          description: The action (create/update/delete)
          type: string
          enum:
            CREATE
            UPDATE
            DELETE
        link:
          description: The entity callback link to MDM
          type: string
